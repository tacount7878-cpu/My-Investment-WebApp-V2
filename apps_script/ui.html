<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>Trade Input V6.1</title>

<style>
:root{
  --bg0:#070b12; --bg1:#0b1220;
  --card:#0f1a2c; --txt:#e8eefc;
  --muted:#a9b6d6; --line:rgba(255,255,255,.08);
  --blue:#2f7bff; --blue2:#1a57c8;
  --red:#ff3b30; --shadow: 0 18px 60px rgba(0,0,0,.45);
  --radius:18px;
}
*{box-sizing:border-box;}
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Noto Sans TC",Arial;
  background:linear-gradient(180deg,var(--bg0),var(--bg1));
  color:var(--txt);
  padding:20px;
}
.card{
  max-width:520px;
  margin:auto;
  background:rgba(255,255,255,.05);
  border:1px solid var(--line);
  border-radius:var(--radius);
  box-shadow:var(--shadow);
  padding:20px;
}
.title{font-size:22px;font-weight:900;margin-bottom:10px;}
.hint{color:var(--muted);font-size:14px;margin:6px 0;}
.bigInput{
  width:100%;height:60px;font-size:20px;font-weight:800;
  background:rgba(0,0,0,.25);color:white;
  border:1px solid var(--line);
  border-radius:14px;padding:0 14px;
}
.bigInput:focus{
  border-color:var(--blue);
  box-shadow:0 0 0 4px rgba(47,123,255,.2);
}
.chips{display:flex;flex-wrap:wrap;gap:8px;margin-top:8px;}
.chip{
  padding:8px 12px;border-radius:999px;
  background:rgba(47,123,255,.15);
  border:1px solid rgba(47,123,255,.35);
  font-size:13px;font-weight:800;
  cursor:pointer;
}
button.primary{
  width:100%;height:60px;
  margin-top:16px;
  border-radius:16px;
  background:linear-gradient(180deg,var(--blue),var(--blue2));
  border:none;color:white;
  font-size:18px;font-weight:900;
}
.toast{
  margin-top:12px;font-weight:800;
}
</style>
</head>

<body>

<div class="card">

<div class="title">Trade Input</div>

<div class="hint">交易類型</div>
<select id="type" class="bigInput">
  <option value="買入">買入</option>
  <option value="賣出">賣出</option>
</select>

<div class="hint">標的名稱（必填）</div>
<input id="name" class="bigInput" placeholder="例如：富邦台50">

<div class="hint">股票代號</div>
<input id="symbol" class="bigInput" placeholder="例如：006208.TW">

<div class="hint">常用快選</div>
<div class="chips">
  <div class="chip" onclick="quick('富邦台50','006208.TW','元大(台股)')">富邦台50</div>
  <div class="chip" onclick="quick('台積電','2330.TW','元大(台股)')">台積電</div>
  <div class="chip" onclick="quick('VWRA全球股票','VWRA.L','IBKR')">VWRA</div>
  <div class="chip" onclick="quick('特斯拉(FT)','TSLA','Firstrade(FT)')">TSLA(FT)</div>
  <div class="chip" onclick="quick('比特幣','BTC-USD','錢包')">比特幣</div>
</div>

<div class="hint">價格</div>
<input id="price" class="bigInput" inputmode="decimal">

<div class="hint">股數</div>
<input id="qty" class="bigInput" inputmode="decimal">

<div class="hint">手續費</div>
<input id="fee" class="bigInput" placeholder="未填自動 0" inputmode="decimal">

<div class="hint">交易稅</div>
<input id="tax" class="bigInput" placeholder="未填自動 0" inputmode="decimal">

<div class="hint">成本（賣出必填）</div>
<input id="cost" class="bigInput" inputmode="decimal">

<div class="hint">平台</div>
<select id="platform" class="bigInput">
  <option value="元大(台股)">元大(台股)</option>
  <option value="元大複委託(美股)">元大複委託(美股)</option>
  <option value="Firstrade(FT)">Firstrade(FT)</option>
  <option value="IBKR">IBKR</option>
  <option value="錢包">錢包</option>
</select>

<div class="hint">帳戶類型</div>
<select id="account" class="bigInput">
  <option value="TWD帳戶">TWD帳戶</option>
  <option value="USD外幣帳戶">USD外幣帳戶</option>
  <option value="其他">其他</option>
</select>

<button class="primary" onclick="submitTrade()">送出交易</button>

<div id="msg" class="toast"></div>

</div>

<script>

function quick(name,symbol,platform){
  document.getElementById("name").value=name;
  document.getElementById("symbol").value=symbol;
  document.getElementById("platform").value=platform;
}

function submitTrade(){

  const name=document.getElementById("name").value.trim();
  const type=document.getElementById("type").value;
  const cost=document.getElementById("cost").value;

  if(!name){
    show("❌ 名稱不可空白"); return;
  }

  if(type==="賣出" && !cost){
    show("❌ 賣出必須填成本"); return;
  }

  const payload={
    defaults:{
      platform:document.getElementById("platform").value,
      account:document.getElementById("account").value
    },
    trades:[{
      type:type,
      name:name,
      symbol:document.getElementById("symbol").value,
      price:Number(document.getElementById("price").value||0),
      qty:Number(document.getElementById("qty").value||0),
      fee:Number(document.getElementById("fee").value||0),
      tax:Number(document.getElementById("tax").value||0),
      cost:Number(cost||0),
      date:new Date().toLocaleDateString('zh-TW')
    }]
  };

  google.script.run
    .withSuccessHandler(res=>{
      show("✅ 成功寫入第 "+res.row+" 列");
      clearForm();
    })
    .withFailureHandler(err=>{
      show("❌ "+err.message);
    })
    .saveTrades(payload);
}

function show(msg){
  document.getElementById("msg").innerText=msg;
}

function clearForm(){
  ["name","symbol","price","qty","fee","tax","cost"].forEach(id=>{
    document.getElementById(id).value="";
  });
}

</script>

</body>
</html>
